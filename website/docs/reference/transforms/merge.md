---
description: "The Vector [`merge`](#merge) transform accepts `log` events and allows you to merge partial log events into a single event."
event_types: ["log"]
issues_url: https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22transform%3A+merge%22
sidebar_label: "merge|[\"log\"]"
source_url: https://github.com/timberio/vector/tree/master/src/transforms/merge.rs
status: "prod-ready"
title: "Merge Transform"
---

The Vector [`merge`](#merge) transform accepts [`log`][docs.data-model.log] events and allows you to merge partial log events into a single event.

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the template located at:

     website/docs/reference/transforms/merge.md.erb
-->

## Configuration

import CodeHeader from '@site/src/components/CodeHeader';

<CodeHeader fileName="vector.toml" learnMoreUrl="/docs/setup/configuration/"/ >

```toml
[transforms.my_transform_id]
  # REQUIRED
  type = "merge" # must be: "merge"
  inputs = ["my-source-id"] # example

  # OPTIONAL
  merge_fields = ["message"] # default
  partial_event_marker = "_partial" # default
```

## Options

import Fields from '@site/src/components/Fields';

import Field from '@site/src/components/Field';

<Fields filters={true}>


<Field
  common={true}
  defaultValue={["message"]}
  enumValues={null}
  examples={[["message"]]}
  name={"merge_fields"}
  nullable={false}
  path={null}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"[string]"}
  unit={null}
  >

### merge_fields

Fields to merge.

The values of these fields will be merged into the _first_ partial event. Fields not specified here will be ignored. Merging process takes the first buffered partial event, then loops over the rest of them and merges in the fields from each buffered partial event. The last event with the field takes priority and overrides the previous event.

Finally, the non-partial event fields are merged in, producing the resulting merged event.


</Field>


<Field
  common={true}
  defaultValue={"_partial"}
  enumValues={null}
  examples={["_partial"]}
  name={"partial_event_marker"}
  nullable={false}
  path={null}
  relevantWhen={null}
  required={false}
  templateable={false}
  type={"string"}
  unit={null}
  >

### partial_event_marker

The field that indicates that the event is partial. A consequent stream of partial events along with the first non-partial event will be merged together.


</Field>


</Fields>

## Output

The [`merge`](#merge) transform accepts [`log`][docs.data-model.log] events and allows you to merge partial log events into a single event.
For example:


import Tabs from '@theme/Tabs';

<Tabs
  block={true}
  defaultValue="default"
  values={[{"label":"Default","value":"default"},{"label":"With Merge Fields","value":"with-merge-fields"}]}>

import TabItem from '@theme/TabItem';

<TabItem value="default">

Given the following _default_ configuration:

<CodeHeader fileName="vector.toml" />

```toml
[transforms.merge_events]
  type = "merge"
  inputs = [...]
```

And these two partial [`log` events][docs.data-model.log]:

<CodeHeader fileName="first log event" />

```javascript
{
  "message": "First",
  "_partial": true,
  "custom_field": "value1"
}
```

and

<CodeHeader fileName="second log event" />

```javascript
{
  "message": "Second",
  "_partial": true,
  "custom_field": "value2"
}
```

A single _merged_ log event will be produced:

```javascript
{
  "message": "FirstSecond",
  "custom_field": "value1"
}
```

Notice that `custom_field` is not overridden. This is because it was not specified in the [`merge_fields`](#merge_fields) option.

</TabItem>

<TabItem value="with-merge-fields">

Given the following _default_ configuration:

<CodeHeader fileName="vector.toml" />

```toml
[transforms.merge_events]
  type = "merge"
  inputs = [...]
  merge_fields = ["message", "custom_field"]
```

And these two partial [`log` events][docs.data-model.log]:

<CodeHeader fileName="first log event" />

```javascript
{
  "message": "First",
  "_partial": true,
  "custom_field": "value1"
}
```

and

<CodeHeader fileName="second log event" />

```javascript
{
  "message": "Second",
  "_partial": true,
  "custom_field": "value2"
}
```

A single _merged_ log event will be produced:

```javascript
{
  "message": "FirstSecond",
  "custom_field": "value2"
}
```

Notice that `custom_field` is overridden. This is because it was specified in the [`merge_fields`](#merge_fields) option.

</TabItem>
</Tabs>

## How It Works

### Environment Variables

Environment variables are supported through all of Vector's configuration.
Simply add `${MY_ENV_VAR}` in your Vector configuration file and the variable
will be replaced before being evaluated.

You can learn more in the [Environment Variables][docs.configuration#environment-variables]
section.


[docs.configuration#environment-variables]: /docs/setup/configuration/#environment-variables
[docs.data-model.log]: /docs/about/data-model/log/
