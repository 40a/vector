# Environment Variables Example
# ------------------------------------------------------------------------------
# A simple example that demonstrates Vector's environment variable
# interpolation syntax. More information can be found in the Environment
# Variables section in our docs:
#
# https://vector.dev/docs/setup/configuration#environment-variables

digraph {
  data_dir = "/var/lib/vector"

  subgraph sources {
    # Ingests Apache 2 log data by tailing one or more log files
    # Example: 194.221.90.140 - - [22/06/2019:11:55:14 -0400] "PUT /integrate" 100 2213
    # Docs: https://vector.dev/docs/reference/sources/file
    apache_logs [
      type = "file"
      include = "/var/log/apache2/*.log"
      ignore_older = 86400 # 1 day
    ]
  }

  subgraph transforms {
    # Add a field based on the value of the HOSTNAME env var
    # Docs: https://vector.dev/docs/reference/transforms/add_fields
    add_host [
      type = "add_fields"
      "fields.host" = "${HOSTNAME}"
    ]
  }

  subgraph sinks {
    # Print the data to STDOUT for inspection
    # Docs: https://vector.dev/docs/reference/sinks/console
    out [
      type = "console"
      encoding = "json"
    ]
  }

  # Set up the data flow
  apache_logs -> add_host -> out
}
